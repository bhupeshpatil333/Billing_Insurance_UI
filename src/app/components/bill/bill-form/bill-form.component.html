<div class="space-y-6">
    <!-- Page Header -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Generate Bill</h1>
        <p class="text-gray-600">Create a new bill for patient services</p>
    </div>

    <!-- Form Card -->
    <div class="bg-white rounded-xl shadow-lg p-8 max-w-3xl">
        <form (ngSubmit)="generateBill()" class="space-y-6">

            <!-- Patient Selection -->
            <mat-form-field class="w-full">
                <mat-label>Select Patient</mat-label>
                <mat-select [(ngModel)]="patientId" name="patient" required>
                    <mat-option *ngFor="let p of patients" [value]="p.patientId">
                        {{ p.fullName }}
                    </mat-option>
                </mat-select>
                <mat-icon matPrefix>person</mat-icon>
                <mat-error *ngIf="!patientId">
                    <mat-icon class="text-xs align-middle">error</mat-icon>
                    Patient selection is required to generate a bill
                </mat-error>
            </mat-form-field>

            <!-- Services Selection -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-3">
                    <span class="mr-2">üè•</span>
                    Select Services
                </label>
                <div class="space-y-2 max-h-96 overflow-y-auto border-2 border-gray-200 rounded-lg p-4"
                    [class.border-red-500]="calculateTotal() === 0 && patientId">
                    <div *ngFor="let service of services"
                        class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-indigo-50 transition-colors cursor-pointer">
                        <label class="flex items-center flex-1 cursor-pointer">
                            <input type="checkbox" [value]="service" [(ngModel)]="service.selected"
                                [ngModelOptions]="{standalone: true}"
                                class="w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 mr-3">
                            <div class="flex-1">
                                <span class="font-medium text-gray-800">{{ service.serviceName }}</span>
                            </div>
                            <span class="text-lg font-bold text-indigo-600">‚Çπ{{ service.cost }}</span>
                        </label>
                    </div>
                </div>
                <!-- Service Validation Error -->
                <div *ngIf="calculateTotal() === 0 && patientId" class="mt-2 text-red-500 text-xs flex items-center">
                    <mat-icon class="text-xs mr-1">error</mat-icon>
                    Please select at least one service to generate a bill
                </div>
            </div>

            <!-- Total Amount -->
            <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 border-2 border-indigo-200">
                <div class="flex items-center justify-between">
                    <span class="text-lg font-semibold text-gray-700">Total Amount:</span>
                    <span class="text-3xl font-bold text-indigo-600">
                        ‚Çπ{{ calculateTotal() }}
                    </span>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="flex space-x-4 pt-4">
                <button type="submit" [disabled]="!patientId || calculateTotal() === 0"
                    class="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 active:scale-95">
                    <span class="mr-2">üí∞</span>
                    Generate Bill
                </button>
                <button type="button"
                    class="px-6 py-3 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50 transition-colors">
                    Clear
                </button>
            </div>
        </form>
    </div>
</div>